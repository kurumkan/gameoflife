<!DOCTYPE html>
<html>
<head>
	<title>test</title>
</head>
<body>
<canvas id="canvas" width="500" height="300"></canvas>
</body>
<script type="text/javascript">
	var canvas = document.getElementById("canvas");
	var context = canvas.getContext("2d");	
	var requestId;
	var body=document.querySelector("body");
	body.addEventListener("click", stop, false);

	function stop(){
		cancelAnimationFrame(requestId);
	}

	var x=0;
	var y=1;
	var framesPerSecond = 1000;
	function animate(){
		setTimeout(function(){
			context.fillStyle="#fff";
			context.fillRect(0,0,500,300);

			context.fillStyle="#f00";
			context.fillRect(x,y,100,100);

			x++;
			if(x>500)x=0;

			requestId = requestAnimationFrame(animate);
		}, 1000/framesPerSecond);
	}

	animate();

</script>
</html>